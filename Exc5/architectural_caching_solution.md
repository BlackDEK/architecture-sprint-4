# Архитектурное решение по кешированию

## Анализ

- Проблема с производительностью сейчас наблюдается в контейнере MES, она связана с долгой загрузкой данных из MES db, для решения этой проблемы необходимо внедрить кеширование данных MES db.
- Список данных для кэширования. Данная информация позволит оператором быстро ориентироваться и брать новые заказы.
  - Id заказа.
  - Статус заказа.
  - Id оператора взявшего этот заказ.
  - Время создания заказа.

## Мотивация

- Как кэширование поможет работе MES?
  - Оно уменьшит нагрузку на сервер.
  - Оно повысит скорость работы операторов.

## Предлагаемое решение

- Каким будет кэширование?
  - Серверным.
    - Почему?
      - Инвалидация кэша будет происходить не по времени, поэтом нам не подойдет клиентское кэширование.
  - В качестве паттерна на чтение будем использовать Read-Through.
    - Почему?
      - Такой подход позволяет не писать сторонний код, а использовать встроенные возможности БД.
      - БД будет обновлять кэш.
  - В качестве паттерна на запись будем использовать Write-Through.
    - Почему?
      - Такой подход позволит обновлять БД и кэш в в синхронном порядке при формировании заказа, это проще реализовать.
      - БД будет обновлять кэш.
- Почему не подошли другие подходы?
  - Refresh-ahead. Подвержен ошибкам, поэтому нужна система мониторинга.
  - Write-Behind. Асинхронное обновление сложнее реализовать.
- Как будет инвалидироваться кэш?
  - По ключу, то есть по id заказа.
    - Почему?
      - Такой подход позволит обеспечить актуальность кэша для операторов, так как им важно знать когда заказ будет взят.
      - Также такой подход позволит обновлять только те заказы которые были изменены.

## Диаграмму последовательности событий

- [Диаграмма на чтение из кэша](./cache_read.puml)
- [Диаграмма на запись из кэша](./cache_write.puml)
